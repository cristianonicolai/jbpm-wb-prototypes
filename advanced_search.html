<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>KIE Workench</title>

    <!-- PatternFly Styles -->
    <link href="bower_components/patternfly/dist/css/patternfly.min.css" rel="stylesheet" media="screen, print">
    <link href="bower_components/patternfly/dist/css/patternfly-additions.min.css" rel="stylesheet" media="screen, print">

    <!-- Custom CSS -->
    <link href="kie.css" rel="stylesheet" media="screen, print">

    <!-- jQuery -->
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="bower_components/moment/min/moment.min.js"></script>
    <script src="bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
    <!-- PatternFly -->
    <script src="bower_components/patternfly/dist/js/patternfly.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default navbar-pf" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
            <img src="logo.png" alt="PatternFly Enterprise Application"/>
        </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
        <ul class="nav navbar-nav navbar-utility">
            <li class="dropdown-toggle">
                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-question"></i>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li class="dropdown-header">-- None --</li>
                </ul>
            </li>
            <li><a href="javascript:;"><i class="fa fa-cog"></i> </a></li>
            <li title="Apps launcher" class="dropdown" style="display: none;" aria-hidden="true">
                <a href="javascript:;" data-toggle="dropdown"><i class="fa fa-th"></i> </a>
                <div class="dropdown-menu infotip bottom-right kie-launcher" data-i18n-prefix="AppLauncherView.">
                    <div class="arrow"></div>
                    <div class="container-fluid">
                        <div class="row">
                            <div data-field="left-column" class="col-sm-6"></div>
                            <div data-field="right-column" class="col-sm-6"></div>
                        </div>
                    </div>
                </div>
            </li>
            <li title="About"><a href="javascript:;"><i class="fa fa-info-circle"></i> </a></li>
            <li title="Reset all Perspective layouts"><a href="javascript:;"><i class="fa fa-medkit"></i> </a></li>
            <li class="dropdown">
                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"><span class="pficon pficon-user"></span>admin<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Switch to Compact View</a></li>
                    <li><a href="javascript:;">Role: analyst</a></li>
                    <li><a href="javascript:;">Role: admin</a></li>
                    <li><a href="javascript:;">Log Out</a></li>
                </ul>
            </li>
        </ul>
        <ul class="nav navbar-nav navbar-primary">
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Home<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li class=""><a href="javascript:;">Home Page</a></li>
                    <li><a href="javascript:;">Admin</a></li>
                    <li><a href="javascript:;">Timeline</a></li>
                    <li><a href="javascript:;">People</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Authoring<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Project Authoring</a></li>
                    <li><a href="javascript:;">Contributors</a></li>
                    <li><a href="javascript:;">Artifact Repository</a></li>
                    <li><a href="javascript:;">Administration</a></li>
                    <li><a href="javascript:;">Library</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Deploy<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Execution Servers</a></li>
                    <li><a href="javascript:;">Jobs</a></li>
                </ul>
            </li>
            <li class="dropdown active">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown" aria-expanded="false"> Process Management<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Process Definitions</a></li>
                    <li class="active"><a href="javascript:;">Process Instances</a></li>
                </ul>
            </li>
            <li><a href="javascript:;">Tasks</a></li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Dashboards<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Process &amp; Task Dashboard</a></li>
                    <li><a href="javascript:;">Business Dashboards</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Extensions<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Plugin Management</a></li>
                    <li><a href="javascript:;">Apps</a></li>
                    <li><a href="javascript:;">Data Sets</a></li>
                    <li><a href="javascript:;">Data Sources</a></li>
                </ul>
            </li>
        </ul>

    </div>
</nav>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12 kie-container">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="uf-listbar-panel-header-toolbar">
                        <div class="btn-toolbar">
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm">New Process Instance</button>
                                <div class="btn-group" style="display: none;" aria-hidden="true">
                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">Server Templates
                                        <span class="caret"></span></button>
                                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                </div>
                                <button type="button" class="btn btn-default btn-sm" title="Refresh">
                                    <i class="fa fa-refresh"></i></button>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" title="Auto Refresh">
                                        <i class="fa fa-cog"></i> <span class="caret"></span></button>
                                    <ul class="dropdown-menu pull-right" role="menu">
                                        <li><a href="javascript:;">1 Minute</a></li>
                                        <li><a href="javascript:;">5 Minutes</a></li>
                                        <li><a href="javascript:;">10 Minutes</a></li>
                                        <li class="divider"></li>
                                        <li class="disabled" disabled="">
                                            <a href="javascript:;" class="disabled" disabled="">Auto refresh Disabled</a>
                                        </li>
                                    </ul>
                                </div>
                                <button type="button" class="btn btn-default btn-sm" title="Restore default filters">
                                    <i class="fa fa-filter"></i></button>
                            </div>
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm" title="Maximize panel to fit full screen">
                                    <i class="fa fa-expand"></i></button>
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <h3 class="panel-title">Process Instances</h3>
                </div>
                <div class="panel-body">
                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#">Search</a></li>
                        <li id="activeTab"><a href="#">Active <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('activeTab');"><i class="fa fa-times"></i> </button></a></li>
                        <li id="completedTab"><a href="#">Completed <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('completedTab');"><i class="fa fa-times"></i> </button></a></li>
                        <li id="abortedTab"><a href="#">Aborted <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('abortedTab');"><i class="fa fa-times"></i> </button></a></li>
                    </ul>
                    <div class="row toolbar-pf table-view-pf-toolbar" id="toolbar1">
                        <div class="col-sm-12">
                            <form class="toolbar-pf-actions">
                                <div class="form-group toolbar-pf-filter">
                                    <div class="input-group">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <span id="filter">Name</span>
                                                <span class="caret"></span>
                                            </button>
                                            <ul id="filters" class="dropdown-menu">
                                                <li class="hidden"><a href="#" id="filter0" onclick="selectFilter(this);">Name</a></li>
                                                <li><a href="#" id="filter1" onclick="selectFilter(this);">Id</a></li>
                                                <li><a href="#" id="filter2" onclick="selectFilter(this);">Version</a></li>
                                                <li><a href="#" id="filter3" onclick="selectFilter(this);">State</a></li>
                                                <li><a href="#" id="filter4" onclick="selectFilter(this);">Initiator</a></li>
                                                <li><a href="#" id="filter5" onclick="selectFilter(this);">Last Update</a></li>
                                            </ul>
                                        </div>
                                        <select class="selectpicker form-control filter-control" title="Filter By Name..." id="Name">
                                            <option>Evaluation</option>
                                        </select>
                                        <input type="number" class="form-control filter-control hidden" placeholder="Filter By Process Id..." autocomplete="off" id="Id">
                                        <input type="text" class="form-control filter-control hidden" placeholder="Filter By Version..." autocomplete="off" id="Version">
                                        <select class="selectpicker form-control filter-control hidden" title="Filter By State..." id="State">
                                            <option>Active</option>
                                            <option>Aborted</option>
                                            <option>Completed</option>
                                        </select>
                                        <input type="text" class="form-control filter-control hidden" placeholder="Filter By Initiator..." autocomplete="off" id="Initiator" onchange="addFilter('Initiator', this.value); this.value = '';">
                                        <div class="input-group filter-control hidden" id="Last Update">
                                            <input type='text' class="form-control" placeholder="Start date..." id='datetimepickerFrom' />
                                            <div class="input-group-addon">to</div>
                                            <input type='text' class="form-control" placeholder="End date..." id='datetimepickerTo' />
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="dropdown btn-group  dropdown-kebab-pf">
                                        <button class="btn btn-link dropdown-toggle" data-toggle="dropdown" type="button"><i class="fa fa-columns"></i></button>
                                        <ul class="dropdown-menu table-view-pf-colvis-menu" style="margin-left: 5px;">
                                            <li><input type="checkbox" checked><label>Id</label></li>
                                            <li><input type="checkbox" checked><label>Name</label></li>
                                            <li><input type="checkbox" checked><label>Description</label></li>
                                            <li><input type="checkbox" checked><label>Version</label></li>
                                            <li><input type="checkbox" checked><label>Errors</label></li>
                                            <li><input type="checkbox" checked><label>Last Update</label></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="toolbar-pf-action-right">
                                    <div class="form-group">
                                        <button class="btn btn-default" type="button" disabled>
                                            <i class="fa fa-ban"></i> Abort
                                        </button>
                                        <button class="btn btn-default" type="button" disabled>
                                            <i class="fa fa-bell"></i> Signal
                                        </button>
                                    </div>
                                </div>
                            </form>
                            <div class="row toolbar-pf-results">
                                <div class="col-sm-9">
                                    <div>
                                        <p style="padding-right: 5px;">Active filters: </p>
                                        <ul class="list-inline" id="activeFilters">
                                            <!--<li>-->
                                                <!--<span class="label label-info">Name: Evaluation<a href="#" onclick="removeFilter(this);"><span class="pficon pficon-close"></span></a></span>-->
                                            <!--</li>-->
                                            <!--<li>-->
                                                <!--<span class="label label-info">Version: 1<a href="#" onclick="removeFilter(this);"><span class="pficon pficon-close"></span></a></span>-->
                                            <!--</li>-->
                                        </ul>
                                        <p><a href="#" onclick="removeAllFilters();">Clear All Filters</a></p>
                                    </div>
                                </div>
                                <div class="col-sm-3 table-view-pf-select-results">
                                    <a href="#">Save Search</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered">
                        <thead>
                        <tr>
                            <th width="10px"><input type="checkbox"/></th>
                            <th>Id</th>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Version</th>
                            <th>Errors</th>
                            <th>Last Update</th>
                            <th width="250px">Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="checkbox"/></td>
                            <td>1</td>
                            <td>Evaluation</td>
                            <td>Evaluation</td>
                            <td>1</td>
                            <td><span class="label label-default">0</span></td>
                            <td>22/04/2017 09:49</td>
                            <td>
                                <button class="btn btn-default btn-xs" type="button">Signal</button>
                                <button class="btn btn-default btn-xs" type="button">Abort</button>
                                <button class="btn btn-default btn-xs" type="button">View Jobs</button>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="checkbox"/></td>
                            <td>2</td>
                            <td>Evaluation</td>
                            <td>Evaluation</td>
                            <td>1</td>
                            <td><span class="label label-danger">2</span></td>
                            <td>22/04/2017 09:49</td>
                            <td>
                                <button class="btn btn-default btn-xs" type="button">Signal</button>
                                <button class="btn btn-default btn-xs" type="button">Abort</button>
                                <button class="btn btn-default btn-xs" type="button">View Jobs</button>
                                <button class="btn btn-default btn-xs" type="button">View Errors</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table style="width: 100%;" cellspacing="0" cellpadding="0">
                        <tbody>
                        <tr>
                            <td style="vertical-align: middle;" align="left" width="50%">
                                <select class="form-control" style="width: 100px;">
                                    <option value="5">5 Items</option>
                                    <option value="10">10 Items</option>
                                    <option value="15">15 Items</option>
                                    <option value="20">20 Items</option>
                                </select></td>
                            <td style="vertical-align: top;" align="right" width="50%">
                                <table class="pagination pagination-right pull-right GOVM-MUGNB" cellspacing="0" cellpadding="0">
                                    <tbody>
                                    <tr>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-double-left"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-left"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUI5" align="left">
                                            <div class="gwt-HTML">0 of 0</div>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-right"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="" style="">
                                                <i class="fa fa-fast-forward"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="" style="">
                                                <i class="fa fa-angle-double-right"></i></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function removeFilter(element) {
        $(element).remove();
    }

    function selectFilter(element) {
        $('#filter').text(element.text);
        $('#filters li').each(function( index ) {
            var liElement = $( this );
            if(liElement.text() == element.text){
                liElement.addClass( "hidden" );
            } else {
                liElement.removeClass( "hidden" );
            }
        });
        $('.filter-control').each(function( index ) {
            var input = $( this );
            var selects = [ 'Name', 'State' ];
            if(input.attr('id') == element.text){
                if($.inArray(input.attr('id'), selects) != -1){
                    input.parent().removeClass( "hidden" );
                } else {
                    input.removeClass( "hidden" );
                }
                input.focus();
            } else {
                if($.inArray(input.attr('id'), selects) != -1){
                    input.parent().addClass( "hidden" );
                } else {
                    input.addClass( "hidden" );
                }
            }
        });
    }

    function addFilter(name, value) {
        var li = document.createElement( "li" );
        var spanLabel = document.createElement( "span" );
        spanLabel.classList.add('label');
        spanLabel.classList.add('label-info');
        var a = document.createElement( "a" );
        a.href = '#';
        a.onclick = function() {
            removeFilter(li);
        };
        var spanClose = document.createElement( "span" );
        spanClose.classList.add('pficon');
        spanClose.classList.add('pficon-close');

        spanLabel.appendChild(document.createTextNode(name + ': ' + value));
        spanLabel.appendChild(a);
        a.appendChild(spanClose);
        li.appendChild(spanLabel);
        $('#activeFilters').append(li);
    }

    function removeAllFilters() {
        $('#activeFilters li').remove();
    }

    $('.selectpicker').selectpicker();

    var dateFormat = 'DD/MM/YYYY h:mm:ss a';

    $('#datetimepickerFrom').datetimepicker({
        format: dateFormat
    });
    $('#datetimepickerTo').datetimepicker({
        format: dateFormat,
        useCurrent: false //Important! See issue #1075
    });
    $("#datetimepickerFrom").on("dp.change", function (e) {
        $('#datetimepickerTo').data("DateTimePicker").minDate(e.date);
    });
    $("#datetimepickerTo").on("dp.change", function (e) {
        var from = $('#datetimepickerFrom').data("DateTimePicker");
        var to = $('#datetimepickerTo').data("DateTimePicker");

        if(from.date() == null || to.date() == null){
            return;
        }

        var fromDate = from.date().format(dateFormat);
        var toDate = to.date().format(dateFormat);
        addFilter('Last Update', ' Range from ' + fromDate + ' to ' + toDate);
        from.clear();
        from.hide();
        to.clear();
        to.hide();
    });

    function addInputText(input){
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if(keycode == '13'){
            addFilter(input.attr('id'), input.val());
            input.val('');
            input.focus();
        }
    }

    function addSelectText(input){
        addFilter(input.attr('id'), input.val());
        input.val('');
    }

    $("[id='Process Id']").keypress(function(event){ addInputText($(this)); });

    $("[id='Version']").keypress(function(event){ addInputText($(this)); });

    $("[id='Initiator']").keypress(function(event){ addInputText($(this)); });

    $("[id='Name']").on('changed.bs.select', function(event){ addSelectText($(this)); });

    $("[id='State']").on('changed.bs.select', function(event){ addSelectText($(this)); });

    function removeTab(id) {
        $('#' + id).remove();
    }

</script>
</body>
</html>
